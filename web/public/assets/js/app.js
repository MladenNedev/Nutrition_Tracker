function w(){const e=document.getElementById("macroChart");if(!e)return;const o=e.getContext("2d");parseFloat(e.dataset.calories||"0");const u=parseFloat(e.dataset.caloriesGoal||"2000"),d=parseFloat(e.dataset.protein||"0"),n=parseFloat(e.dataset.carbs||"0"),a=parseFloat(e.dataset.fat||"0"),p=d*4,g=n*4,h=a*9,m=p+g+h;let c=u-m;c<0&&(c=0);const i=o.createLinearGradient(0,0,e.width,0);i.addColorStop(0,"#5433FF"),i.addColorStop(.5,"#20BDFF"),i.addColorStop(1,"#6FB1FC");const s=o.createLinearGradient(0,0,e.width,0);s.addColorStop(0,"#f12711"),s.addColorStop(1,"#f5af19");const l=o.createLinearGradient(0,0,e.width,0);l.addColorStop(0,"#bc4e9c"),l.addColorStop(1,"#f80759"),new Chart(o,{type:"doughnut",data:{labels:["Protein","Carbs","Fat","Remaining"],datasets:[{data:[p,g,h,c],backgroundColor:[i,s,l,"#eeeeee"],borderWidth:0}]},options:{cutout:"70%",rotation:-90*(Math.PI/180),responsive:!0,plugins:{legend:{display:!1}}}})}document.addEventListener("DOMContentLoaded",w);document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("food-search"),o=document.getElementById("food-dropdown"),u=document.getElementById("food-id-hidden");if(!e||!o)return;let d=o.querySelectorAll(".dropdown-item"),n=-1,a=Array.from(d),p=null;function g(t){return String(t).replace(/[&<>"]/g,r=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"})[r])}async function h(t){const r=t?`?search=${encodeURIComponent(t)}`:"",f=await fetch(`/foods${r}`);if(!f.ok)return;const y=await f.json(),v=Array.isArray(y.foods)?y.foods:[];m(v)}function m(t){o.innerHTML=t.map(r=>`
      <div data-id="${String(r.id)}" class="dropdown-item" role="option" style="cursor:pointer; padding:0.5rem 1rem;">
        ${g(r.name)}
      </div>
    `).join(""),d=o.querySelectorAll(".dropdown-item"),a=Array.from(d),n=-1,d.forEach(r=>{r.addEventListener("click",function(f){f.preventDefault(),i(this)})})}function c(){d.forEach(t=>t.classList.remove("highlighted")),n>=0&&n<a.length&&(a[n].classList.add("highlighted"),a[n].scrollIntoView({block:"nearest",behavior:"smooth"}))}function i(t){const r=t.textContent.trim(),f=t.getAttribute("data-id");e.value=r,u&&(u.value=f),o.style.display="none",e.setAttribute("aria-expanded","false")}function s(){(!o.style.display||o.style.display==="none")&&h(e.value),o.style.display="block",e.setAttribute("aria-expanded","true")}function l(){setTimeout(()=>{o.style.display="none",e.setAttribute("aria-expanded","false"),n=-1},200)}e.addEventListener("focus",s),e.addEventListener("input",function(){s(),clearTimeout(p),p=setTimeout(()=>{h(e.value)},200)}),e.addEventListener("blur",l),e.addEventListener("keydown",function(t){if(!o.style.display||o.style.display==="none"){(t.key==="ArrowDown"||t.key==="ArrowUp"||t.key==="Enter")&&s();return}t.key==="ArrowDown"?(t.preventDefault(),n=Math.min(n+1,a.length-1),c()):t.key==="ArrowUp"?(t.preventDefault(),n=Math.max(n-1,-1),c()):t.key==="Enter"?(t.preventDefault(),n>=0&&n<a.length?i(a[n]):(a.length===1||a.length>0&&e.value.toLowerCase()===a[0].textContent.toLowerCase())&&i(a[0])):t.key==="Escape"&&l()}),d.forEach(t=>{t.addEventListener("click",function(r){r.preventDefault(),i(this)})}),document.addEventListener("click",function(t){!e.contains(t.target)&&!o.contains(t.target)&&l()}),e&&e.form&&e.form.addEventListener("submit",t=>{u.value||(t.preventDefault(),s(),e.focus())})});console.log("Vite app.js loaded");
